(defpackage :key
  (:use))

(cl:in-package :key)
(cl:defvar *string->key* (cl:make-hash-table :test 'cl:equal))
(cl:defvar *key->symbol* (cl:make-hash-table))

(cl:defmacro defkeycode (name code)
  (cl:when (cl:integerp code)
    (cl:setf code (cl:code-char code)))
  `(cl:progn
     (cl:defconstant ,name ,code)
     (cl:setf (cl:gethash (cl:string ',name) *string->key*) ,code
              (cl:gethash ,code *key->symbol*) ',name)))

(defkeycode |C-@| 0)
(defkeycode ctrl-a 1)
(defkeycode |C-a| 1)
(defkeycode ctrl-b 2)
(defkeycode |C-b| 2)
(defkeycode ctrl-c 3)
(defkeycode |C-c| 3)
(defkeycode ctrl-d 4)
(defkeycode |C-d| 4)
(defkeycode ctrl-e 5)
(defkeycode |C-e| 5)
(defkeycode ctrl-f 6)
(defkeycode |C-f| 6)
(defkeycode ctrl-g 7)
(defkeycode |C-g| 7)
(defkeycode ctrl-h 8)
(defkeycode |C-h| 8)
(defkeycode ctrl-i 9)
(defkeycode |C-i| 9)
(defkeycode ctrl-j 10)
(defkeycode |C-j| 10)
(defkeycode ctrl-k 11)
(defkeycode |C-k| 11)
(defkeycode ctrl-l 12)
(defkeycode |C-l| 12)
(defkeycode ctrl-m 13)
(defkeycode |C-m| 13)
(defkeycode ctrl-n 14)
(defkeycode |C-n| 14)
(defkeycode ctrl-o 15)
(defkeycode |C-o| 15)
(defkeycode ctrl-p 16)
(defkeycode |C-p| 16)
(defkeycode ctrl-q 17)
(defkeycode |C-q| 17)
(defkeycode ctrl-r 18)
(defkeycode |C-r| 18)
(defkeycode ctrl-s 19)
(defkeycode |C-s| 19)
(defkeycode ctrl-t 20)
(defkeycode |C-t| 20)
(defkeycode ctrl-u 21)
(defkeycode |C-u| 21)
(defkeycode ctrl-v 22)
(defkeycode |C-v| 22)
(defkeycode ctrl-w 23)
(defkeycode |C-w| 23)
(defkeycode ctrl-x 24)
(defkeycode |C-x| 24)
(defkeycode ctrl-y 25)
(defkeycode |C-y| 25)
(defkeycode ctrl-z 26)
(defkeycode |C-z| 26)
(defkeycode escape 27)

(defkeycode |Space| #x20)
(defkeycode |~| #\~)
(defkeycode |a| #\a)
(defkeycode |b| #\b)
(defkeycode |c| #\c)
(defkeycode |d| #\d)
(defkeycode |e| #\e)
(defkeycode |f| #\f)
(defkeycode |g| #\g)
(defkeycode |h| #\h)
(defkeycode |i| #\i)
(defkeycode |j| #\j)
(defkeycode |k| #\k)
(defkeycode |l| #\l)
(defkeycode |m| #\m)
(defkeycode |n| #\n)
(defkeycode |o| #\o)
(defkeycode |p| #\p)
(defkeycode |q| #\q)
(defkeycode |r| #\r)
(defkeycode |s| #\s)
(defkeycode |t| #\t)
(defkeycode |u| #\u)
(defkeycode |v| #\v)
(defkeycode |w| #\w)
(defkeycode |x| #\x)
(defkeycode |y| #\y)
(defkeycode |z| #\z)
(defkeycode |<| #\<)
(defkeycode |>| #\>)
(defkeycode |v| #\v)
(defkeycode |]| #\])
(defkeycode |[| #\[)
(defkeycode |@| #\@)
(defkeycode |^| #\^)
(defkeycode |(| #\()
(defkeycode |)| #\))
(defkeycode |{| #\{)
(defkeycode |}| #\})
(defkeycode |/| #\/)
(defkeycode |?| #\?)
(defkeycode |;| #\;)
(defkeycode |#| #\#)
(defkeycode |0| #\0)
(defkeycode |1| #\1)
(defkeycode |2| #\2)
(defkeycode |3| #\3)
(defkeycode |4| #\4)
(defkeycode |5| #\5)
(defkeycode |6| #\6)
(defkeycode |7| #\7)
(defkeycode |8| #\8)
(defkeycode |9| #\9)
(defkeycode down #o402)
(defkeycode |down| #o402)
(defkeycode up #o403)
(defkeycode |up| #o403)
(defkeycode left #o404)
(defkeycode |left| #o404)
(defkeycode right #o405)
(defkeycode |right| #o405)
(defkeycode ctrl-down 525)
(defkeycode |C-down| 525)
(defkeycode ctrl-up 566)
(defkeycode |C-up| 566)
(defkeycode ctrl-left 545)
(defkeycode |C-left| 545)
(defkeycode ctrl-right 560)
(defkeycode |C-right| 560)
(defkeycode home #o406)
(defkeycode backspace #o407)
(defkeycode |backspace| #o407)
(defkeycode f0 #o410)
(defkeycode f1 #o411)
(defkeycode f2 #o412)
(defkeycode f3 #o413)
(defkeycode f4 #o414)
(defkeycode f5 #o415)
(defkeycode f6 #o416)
(defkeycode f7 #o417)
(defkeycode f8 #o420)
(defkeycode f9 #o421)
(defkeycode f10 #o422)
(defkeycode f11 #o423)
(defkeycode f12 #o424)
(defkeycode dl #o510)
(defkeycode il #o511)
(defkeycode dc #o512)
(defkeycode |dc| #o512)
(defkeycode ctrl-dc 519)
(defkeycode |C-dc| 519)
(defkeycode ic #o513)
(defkeycode eic #o514)
(defkeycode clear #o515)
(defkeycode eos #o516)
(defkeycode eol #o517)
(defkeycode sf #o520)
(defkeycode sr #o521)
(defkeycode npage #o522)
(defkeycode ppage #o523)
(defkeycode stab #o524)
(defkeycode ctab #o525)
(defkeycode catab #o526)
(defkeycode enter #o527)
(defkeycode print #o532)
(defkeycode ll #o533)
(defkeycode a1 #o534)
(defkeycode a3 #o535)
(defkeycode b2 #o536)
(defkeycode c1 #o537)
(defkeycode c3 #o540)
(defkeycode btab #o541)
(defkeycode beg #o542)
(defkeycode cancel #o543)
(defkeycode close #o544)
(defkeycode command #o545)
(defkeycode copy #o546)
(defkeycode create #o547)
(defkeycode end #o550)
(defkeycode exit #o551)
(defkeycode find #o552)
(defkeycode help #o553)
(defkeycode mark #o554)
(defkeycode message #o555)
(defkeycode move #o556)
(defkeycode next #o557)
(defkeycode open #o560)
(defkeycode options #o561)
(defkeycode previous #o562)
(defkeycode redo #o563)
(defkeycode reference #o564)
(defkeycode refresh #o565)
(defkeycode replace #o566)
(defkeycode restart #o567)
(defkeycode resume #o570)
(defkeycode save #o571)
(defkeycode sbeg #o572)
(defkeycode scancel #o573)
(defkeycode scommand #o574)
(defkeycode scopy #o575)
(defkeycode screate #o576)
(defkeycode sdc #o577)
(defkeycode sdl #o600)
(defkeycode select #o601)
(defkeycode send #o602)
(defkeycode seol #o603)
(defkeycode sexit #o604)
(defkeycode sfind #o605)
(defkeycode shelp #o606)
(defkeycode shome #o607)
(defkeycode sic #o610)
(defkeycode sleft #o611)
(defkeycode smessage #o612)
(defkeycode smove #o613)
(defkeycode snext #o614)
(defkeycode soptions #o615)
(defkeycode sprevious #o616)
(defkeycode sprint #o617)
(defkeycode sredo #o620)
(defkeycode sreplace #o621)
(defkeycode sright #o622)
(defkeycode srsume #o623)
(defkeycode ssave #o624)
(defkeycode ssuspend #o625)
(defkeycode sundo #o626)
(defkeycode suspend #o627)
(defkeycode undo #o630)
(defkeycode mouse #o631)
(defkeycode resize #o632)
(defkeycode event #o633)

(cl:defun ctrl-p (c)
  (cl:char<= |C-@| c |C-z|))
